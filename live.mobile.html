<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Cuadrantes de turnos · APP</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" sizes="192x192" href="icons/icon-192.png">
  <link rel="apple-touch-icon" href="icons/icon-192.png">

  <!-- Estilos -->
  <link rel="stylesheet" href="styles.css?v=app">
  <link rel="stylesheet" href="styles.mobile.css?v=app">

  <style>
    .app-bar{display:flex;align-items:center;gap:.75rem;background:#11171d;color:#e8eef6;padding:.8rem 1rem;border-bottom:1px solid #202a33}
    .app-logo{width:34px;height:34px;border-radius:8px;background:#0e1116}
    .app-title{font-weight:700;font-size:1.05rem;margin:0}
    .app-sub{font-size:.8rem;color:#9cb3c9;margin-top:-.2rem}
    .app-bar-right{margin-left:auto}
    .btn{background:#2a2f37;color:#e8eef6;padding:.55rem .8rem;border-radius:.6rem;border:0}
    .btn-primary{background:#1f6fff;color:#fff}
    main{padding:1rem}
  </style>
</head>
<body>
  <header class="app-bar">
    <img src="icons/icon-192.png" alt="Turnos Recepción" class="app-logo">
    <div>
      <h1 class="app-title">Cuadrantes de turnos</h1>
      <div class="app-sub">Sercotel Guadiana / Cumbria Spa&Hotel</div>
    </div>
    <div class="app-bar-right">
      <button id="btnFilters" class="btn btn-primary">Filtros</button>
    </div>
  </header>

  <!-- Drawer de filtros -->
  <section id="filtersDrawer" class="filters-drawer hidden" aria-hidden="true">
    <div class="filters-card">
      <header class="filters-head">
        <h2>Filtros</h2>
        <button id="btnCloseFilters" class="btn" aria-label="Cerrar">✕</button>
      </header>

      <div class="filters-grid">
        <label><span>Hotel</span><select id="hotelSelect"></select></label>
        <label><span>Empleado</span><select id="employeeFilter"></select></label>
        <label><span>Desde</span><input id="dateFrom" type="text" inputmode="none" autocomplete="off"></label>
        <label><span>Hasta</span><input id="dateTo"   type="text" inputmode="none" autocomplete="off"></label>
      </div>

      <footer class="filters-actions">
        <button id="btnPrevW"  class="btn">← Semana</button>
        <button id="btnTodayW" class="btn">Hoy</button>
        <button id="btnNextW"  class="btn">Semana →</button>
        <button id="btnApply"  class="btn btn-primary">Aplicar</button>
      </footer>
    </div>
    <div class="backdrop" tabindex="-1"></div>
  </section>

  <main><div id="app"></div></main>

  <!-- 1) DATOS: imprescindible para que haya FULL_DATA -->
  <script src="data.js?v=app"></script>

  <!-- 2) Bandera APP (lo usa el patch) -->
  <script>window.IS_APP = true;</script>

  <!-- 3) Flatpickr -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>

  <!-- 4) Adaptador de cuadrante -->
  <script src="plantilla_adapter_semana.js?v=app"></script>

  <!-- 5) Lógica móvil (abre filtros, fechas y llama a renderContent) -->
  <script src="mobile.patch.js?v=app"></script>

  <!-- 6) Service Worker (ahora sí, dentro de <script>) -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js', { updateViaCache: 'none' })
        .then(reg => reg.update())
        .catch(() => {});
    }
  </script>
</body>
</html>
