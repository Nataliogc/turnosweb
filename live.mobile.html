<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover"
  />
  <title>Cuadrantes de turnos – Móvil</title>

  <!-- Estilos (el BAT sustituye ?v=APP por la marca de tiempo) -->
  <link rel="stylesheet" href="styles.css?v=APP">
  <link rel="stylesheet" href="styles.mobile.css?v=APP">

  <!-- Icono -->
  <link rel="icon" href="Logo.png">

  <style>
    /* Ajustes mínimos del modal de filtros para móvil */
    .m-modal-backdrop{
      position:fixed;inset:0;background:rgba(12,18,27,.45);
      display:none;align-items:flex-start;justify-content:center;
      z-index:9998;
      -webkit-backdrop-filter:saturate(180%) blur(3px);
      backdrop-filter:saturate(180%) blur(3px);
    }
    .m-modal{width:min(720px,96vw);margin:10px auto;background:#131a23;color:#eef2f6;
      border-radius:14px;box-shadow:0 10px 40px rgba(0,0,0,.35);padding:16px 16px 12px}
    .m-modal h3{margin:0 0 8px;font:600 20px/1.2 system-ui,Segoe UI,Roboto,Arial}
    .m-row{display:grid;gap:10px;margin:12px 0}
    @media (min-width:560px){.m-row{grid-template-columns:1fr 1fr}}
    .m-field{display:flex;flex-direction:column;gap:6px;background:#0f151d;border-radius:12px;padding:12px}
    .m-label{font:600 13px/1 system-ui,Segoe UI;color:#e6edf3}
    .m-help{opacity:.7;font-weight:500}
    .m-btns{display:flex;gap:10px;margin-top:8px}
    .m-btn{padding:10px 16px;border-radius:10px;border:0;cursor:pointer}
    .m-btn.primary{background:#0ea5e9;color:#07131c;font-weight:700}
    .m-btn.ghost{background:#1d2633;color:#dbe7f3;font-weight:700}
    select, input[type="date"], input[type="text"]{
      width:100%;height:44px;border-radius:10px;border:1px solid #2a3647;
      background:#0c121b;color:#e6edf3;padding:0 12px;font:600 15px/1 system-ui,Segoe UI;
    }
    .toolbar{display:flex;gap:10px;align-items:center}
    .toolbar .btn{background:#1d2633;color:#e7eef9;border-radius:12px;padding:8px 14px;font-weight:700}
    .toolbar .btn.primary{background:#0ea5e9;color:#062232}
    .hint{padding:18px;color:#4b647a}
    /* Asegurar que el selector nativo/calendario quede por encima del modal */
    .flatpickr-calendar{z-index:99999!important}
    input::-webkit-calendar-picker-indicator{opacity:.9}
  </style>
</head>
<body>

  <header class="header">
    <div class="title">
      <img src="Logo.png" alt="" class="app-logo" style="width:32px;height:32px;border-radius:8px;margin-right:8px">
      <div>
        <div class="app-heading">Cuadrantes de turnos</div>
        <div class="app-subtitle">Sercotel Guadiana / Cumbria Spa&Hotel</div>
      </div>
    </div>
    <nav class="toolbar">
      <button id="btnPrev" class="btn">← Semana</button>
      <button id="btnToday" class="btn">Hoy</button>
      <button id="btnNext" class="btn">Semana →</button>
      <button id="btnFilters" class="btn primary">Filtros</button>
    </nav>
  </header>

  <main id="app" class="content">
    <p class="hint">Listo. Abre <strong>Filtros</strong>, elige Hotel/Rango y pulsa <strong>Aplicar</strong>.</p>
  </main>

  <!-- Modal de Filtros -->
  <div id="filtersBackdrop" class="m-modal-backdrop" aria-hidden="true">
    <div role="dialog" aria-modal="true" class="m-modal">
      <h3>Filtros</h3>

      <div class="m-row">
        <div class="m-field">
          <label class="m-label">Hotel</label>
          <select id="fHotel"></select>
        </div>
        <div class="m-field">
          <label class="m-label">Empleado <span class="m-help">(opcional)</span></label>
          <select id="fEmpleado"><option value="">— Empleado —</option></select>
        </div>
      </div>

      <div class="m-row">
        <div class="m-field">
          <label class="m-label">Desde</label>
          <input id="fDesde" type="date" placeholder="dd/mm/aaaa" inputmode="numeric" />
        </div>
        <div class="m-field">
          <label class="m-label">Hasta <span class="m-help">(opcional)</span></label>
          <input id="fHasta" type="date" placeholder="dd/mm/aaaa" inputmode="numeric" />
        </div>
      </div>

      <div class="m-btns">
        <button id="fAplicar" class="m-btn primary">Aplicar</button>
        <button id="fCerrar"  class="m-btn ghost">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- Datos -->
  <script src="data.js?v=APP"></script>

  <!-- Lógica de la app móvil -->
  <script src="mobile.app.js?v=APP"></script>
  <script src="mobile.patch.js?v=APP"></script>

  <!-- Registrar SW sólo en http(s), nunca en file:// para evitar bloqueos -->
  <script>
    if (location.protocol.startsWith('http') && 'serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js').catch(()=>{});
    }
  </script>
</body>
</html>
