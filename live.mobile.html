<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=1" />
  <title>Cuadrantes de turnos · Móvil</title>

  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0b1520">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <link rel="icon" href="img/turnos_icon.png" />
  <link rel="stylesheet" href="styles.css?v=20251109_1605" />
  <link rel="stylesheet" href="styles.mobile.css?v=20251109_1605" />

  <style>
    .app-header{position:sticky;top:0;z-index:10;display:flex;justify-content:space-between;align-items:center;background:#0e1720;color:#f5f7fa;padding:10px 12px}
    .app-header .brand{display:flex;align-items:center;gap:10px}
    .app-header .brand img{width:24px;height:24px;border-radius:6px}
    .app-header .title{font:700 16px/1 system-ui}
    .actions{display:flex;gap:6px}
    .btn{appearance:none;border:1px solid #253040;background:#142130;color:#e6edf5;border-radius:999px;padding:6px 10px;font:600 12px system-ui}
    .btn.primary{background:#0b67ff;border-color:#0b67ff;color:#fff}
    main.wrap{padding:12px}
    @media (min-width:768px){ main.wrap{padding:20px} }

    #drawer{max-width:560px;margin:0 auto;position:fixed;left:0;right:0;bottom:0;transform:translateY(100%);transition:transform .25s ease;background:#fff;border-top-left-radius:16px;border-top-right-radius:16px;box-shadow:0 -10px 30px rgba(0,0,0,.15)}
    #drawer header{padding:14px 14px 0;font:700 14px system-ui;color:#123}
    #drawer .f-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;padding:12px}
    #drawer select,#drawer input{height:36px;font-size:14px;padding:6px 10px;border:1px solid #d6e0ea;border-radius:10px}
    #drawer .f-actions{display:flex;gap:8px;justify-content:flex-end;padding:0 12px 12px}

    .weekCard{ margin:18px 0 26px; }
    .weekHead{ display:flex; align-items:center; gap:12px; margin: 4px 0 10px; }
    .weekHead .weekLogo{ width:42px; height:42px; object-fit:contain; border-radius:10px; }
    .wrap > img:first-child{display:none !important; max-height:0 !important;}

    .grid.grid--fixed{ table-layout: fixed; width: 100%; font-size:13px; }
    .grid.grid--fixed th, .grid.grid--fixed td{ padding:8px 6px; }
    .grid.grid--fixed th:first-child,
    .grid.grid--fixed td:first-child{
      width: 36% !important;
      white-space: normal !important;
      word-break: break-word !important;
      overflow: visible !important;
      text-overflow: clip !important;
      font-weight: 600;
    }
    .grid.grid--fixed th:not(:first-child),
    .grid.grid--fixed td:not(:first-child){
      white-space: normal; /* <- ahora envuelve en móvil */
      overflow: visible;
      text-overflow: clip;
    }

    /* Píldoras compactas y con wrap */
    .pill{display:inline-block;min-width:0;padding:6px 10px;border-radius:999px;font:600 13px/1.1 system-ui;text-align:center;box-shadow:0 1px 0 rgba(0,0,0,.04);white-space:normal}
    .pill--mn{background:#eaf6ee;border:1px solid #bfe6c9;color:#0b6b2e;}
    .pill--ta{background:#fff5d9;border:1px solid #ffe9a8;color:#8a6a00;}
    .pill--no{background:#eef1f5;border:1px solid #d9dee5;color:#2b3645;}
    .pill--de{background:#fde8ea;border:1px solid #f8c7cd;color:#8f1d2d;}
    .pill--va{background:#e9fbfb;border:1px solid #c7f0f0;color:#0b6b6b;}
    .pill--empty{color:#99a3ad}

    /* Aún más compacto en pantallas pequeñas */
    @media (max-width:420px){
      .grid.grid--fixed{ font-size:12px; }
      .grid.grid--fixed th, .grid.grid--fixed td{ padding:6px 4px; }
      .pill{ padding:5px 8px; font-size:12px; }
    }
  </style>
</head>
<body>
  <header class="app-header">
    <div class="brand">
      <img src="img/turnos_icon.png" alt="">
      <div class="title">Cuadrantes de turnos</div>
    </div>
    <div class="actions">
      <button id="btnPrev" class="btn">← Semana</button>
      <button id="btnToday" class="btn">Hoy</button>
      <button id="btnNext" class="btn">Semana →</button>
      <button id="btnFilters" class="btn primary">Filtros</button>
    </div>
  </header>

  <main class="wrap">
    <div id="monthly-summary-container" role="region" aria-live="polite"></div>
  </main>

  <section id="drawer" aria-hidden="true">
    <header>Filtros</header>
    <div class="f-grid">
      <div>
        <label style="display:block;font:600 12px system-ui;color:#345;margin-bottom:6px">Hotel</label>
        <select id="f-hotel"></select>
      </div>
      <div>
        <label style="display:block;font:600 12px system-ui;color:#345;margin-bottom:6px">Semana (lunes)</label>
        <input id="f-week" type="date">
      </div>
    </div>
    <div class="f-actions">
      <button id="f-cancel" class="btn">Cancelar</button>
      <button id="f-apply" class="btn primary">Aplicar</button>
    </div>
  </section>

  <!-- Datos -->
  <script src="data.js?v=20251109_1605"></script>
  <script src="data.ausencias.js?v=20251109_1605"></script>

  <!-- Adaptador móvil -->
  <script src="plantilla_mobile_adapter.js?v=20251109_1605"></script>
  <script>
    window.MobileTemplate = window.MobileTemplate || {};
    if (!window.MobileTemplate.renderContent && typeof window.renderContent === 'function') {
      window.MobileTemplate.renderContent = window.renderContent;
    }
    if (typeof window.buildFD === 'undefined' && typeof window.buildModel === 'function') {
      window.buildFD = window.buildModel;
    }
  </script>

  <script src="mobile.patch.js?v=20251109_1605"></script>
  <script src="mobile.app.js?v=20251109_1605"></script>

  <script>
    if (location.protocol.startsWith('http') && 'serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js').catch(()=>{});
    }
  </script>
</body>
</html>
